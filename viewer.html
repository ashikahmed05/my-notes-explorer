<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Viewer</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #333;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        /* Style for embedded PDFs and images */
        embed, img {
            width: 100%;
            height: 100%;
            border: none;
        }
        /* Style for the download fallback */
        .fallback-container {
            padding: 20px;
        }
        .fallback-container a {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 24px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <p>Loading viewer...</p>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const fileUrl = urlParams.get('file');
        const body = document.body;

        if (fileUrl) {
            const extension = fileUrl.split('.').pop().toLowerCase().split('?')[0];
            
            // Clear the body
            body.innerHTML = '';

            // If it's a common image type, use an <img> tag
            if (['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg'].includes(extension)) {
                const img = document.createElement('img');
                img.src = fileUrl;
                img.alt = "Image file viewer";
                body.appendChild(img);
            } 
            // If it's a PDF, use an <embed> tag
            else if (extension === 'pdf') {
                const embed = document.createElement('embed');
                embed.src = fileUrl;
                embed.type = 'application/pdf';
                body.appendChild(embed);
            } 
            // For anything else, show a download link
            else {
                const container = document.createElement('div');
                container.className = 'fallback-container';
                
                const message = document.createElement('h3');
                message.textContent = "This file can't be previewed directly.";
                
                const link = document.createElement('a');
                link.href = fileUrl;
                link.textContent = 'Download File';

                container.appendChild(message);
                container.appendChild(link);
                body.appendChild(container);
            }
        } else {
            body.innerHTML = '<p>Error: No file specified.</p>';
        }
    </script>
</body>
</html>